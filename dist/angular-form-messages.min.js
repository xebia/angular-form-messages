angular.module("angularFormMessages",[]),angular.module("angularFormMessages").directive("afField",["$rootScope","MESSAGE_TYPES","MessageService",function(a,b,c){return{priority:100,require:["ngModel","afField","^afSubmit","^form"],controller:function(){function a(a){return function(b){c.$messages[b]={type:a}}}var c=this;this.$messages={},this.setMessageDetails=function(b,c){a(c)(b)},this.setErrorDetails=a(b[3]),this.setWarningDetails=a(b[2]),this.setInfoDetails=a(b[1]),this.setSuccessDetails=a(b[0])},link:function(d,e,f,g){function h(){var d=[];angular.forEach(k.$error,function(a,c){d.push({message:c,type:l.$messages[c]&&l.$messages[c].type||b[3]})}),a.$broadcast("validation",n.$name+"."+k.$name,d,c.determineMessageType(d))}function i(){angular.forEach(k.$error,function(a,b){k.$setValidity(b,!0)})}var j,k=g[0],l=g[1],m=g[2],n=g[3],o=f.afTriggerOn||m.triggerOn||c.triggerOn();"change"===o?k.$viewChangeListeners.push(h):"blur"===o&&e.on("blur",function(){d.$apply(h)}),d.$watch(f.afTrigger,function(a,b){b!==a&&h()}),k.$viewChangeListeners.push(function(){j&&(j=!1,i())}),d.$on("validate",function(){i(),k.$validate(),h()}),d.$on("setValidity",function(a,b,c){b===n.$name+"."+k.$name&&(j=!0,angular.forEach(c,function(a){l.setMessageDetails(a.message,a.type),k.$setValidity(a.message,!1)}))})}}}]),angular.module("angularFormMessages").directive("afMessage",["MessageService",function(a){return{scope:!0,require:"^form",link:function(b,c,d,e){var f=d.afMessage||d.afMessageId;a.validation(e.$name+"."+f,function(a){b.messages=a})}}}]),angular.module("angularFormMessages").directive("afSubmit",["$rootScope",function(a){return{require:["form","afSubmit"],controller:angular.noop,link:{pre:function(a,b,c,d){var e=d[1];e.triggerOn=c.afTriggerOn,a.$watch(c.afShowSuccess,function(a){e.showSuccess=!!a})},post:function(b,c,d,e){function f(a){return angular.isObject(a)&&"function"==typeof a.then}function g(c){c.preventDefault(),b.$broadcast("validate"),b.$apply(function(){function c(b){angular.forEach(b.validation,function(b,c){angular.forEach(b,function(b,d){a.$broadcast("setValidity",c+"."+d,b)})})}if(h.$valid){var e=b.$eval(d.afSubmit);f(e)&&(b.isSubmitting=!0,e["catch"](c)["finally"](function(){b.isSubmitting=!1}))}})}var h=e[0];c.on("submit",g)}}}}]),angular.module("angularFormMessages").directive("afSubmitButton",function(){return{link:function(a,b,c){a.$watch("isSubmitting",function(a){c.$set("disabled",a?"disabled":void 0)})}}}),angular.module("angularFormMessages").constant("MESSAGE_TYPES",["SUCCESS","INFO","WARNING","ERROR"]).provider("MessageService",["MESSAGE_TYPES",function(a){var b="change";this.setTriggerOn=function(a){b=a},this.$get=["$injector",function(c){return{determineMessageType:function(b){var c=-1;return angular.forEach(b,function(b){var d=a.indexOf(b.type);d>c&&(c=d)}),-1===c?void 0:a[c]},validation:function(a,b){c.get("$rootScope").$on("validation",function(c,d,e,f){d===a&&b(e,f)})},triggerOn:function(){return b}}}]}]);