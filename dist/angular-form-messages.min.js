angular.module("angularFormMessages",[]),angular.module("angularFormMessages").directive("afField",["$rootScope","MESSAGE_TYPES","MessageService",function(a,b,c){return{priority:100,require:["ngModel","afField","^afSubmit","^form"],controller:function(){function a(a){return function(b){c.$messages[b]={type:a}}}var c=this;this.$messages={},this.setMessageDetails=function(b,c){a(c)(b)},this.setErrorDetails=a(b[3]),this.setWarningDetails=a(b[2]),this.setInfoDetails=a(b[1]),this.setSuccessDetails=a(b[0])},link:function(d,e,f,g){function h(){var d=[];angular.forEach(k.$error,function(a,c){d.push({message:c,type:l.$messages[c]&&l.$messages[c].type||b[3]})}),a.$broadcast("validation",n.$name+"."+k.$name,d,c.determineMessageType(d))}function i(){angular.forEach(k.$error,function(a,b){k.$setValidity(b,!0)})}var j,k=g[0],l=g[1],m=g[2],n=g[3],o=f.afTriggerOn||m.triggerOn||c.triggerOn();if("change"===o){var p=n.$name+'["'+k.$name+'"]';d.$watch("["+p+".$error, "+p+".$dirty]",function(a,b){(a[0]!==b[0]||a[1])&&h()},!0)}else"blur"===o&&e.on("blur",function(){d.$apply(h)});d.$watch(f.afTrigger,function(a,b){b!==a&&h()}),k.$viewChangeListeners.push(function(){j&&(j=!1,i())}),d.$on("validate",function(){i(),k.$validate(),h()}),d.$on("setValidity",function(a,b,c){b===n.$name+"."+k.$name&&(j=!0,angular.forEach(c,function(a){l.setMessageDetails(a.message,a.type),k.$setValidity(a.message,!1)}),h())})}}}]),angular.module("angularFormMessages").directive("afMessage",["MessageService",function(a){return{scope:!0,require:["^form","afMessage"],controller:angular.noop,link:function(b,c,d,e){var f=e[0],g=e[1];g.messageId=f.$name+"."+(d.afMessage||d.afMessageId),a.validation(g.messageId,function(a){b.messages=a})}}}]),angular.module("angularFormMessages").directive("afMessageLabel",["$log","MessageService","translateFilter","TranslateService",function(a,b,c,d){return{restrict:"A",require:"^afMessage",link:function(e,f,g,h){g.$observe("afMessageLabel",function(e){var g=h.messageId+"."+e,i=b.getGenericLabelPrefix()+e,j=c(d.hasLabel(g)?g:i);void 0===j&&a.warn("Missing label: '"+g+"' (specific) or '"+i+"' (generic)"),f.html(void 0===j?e:j)})}}}]),angular.module("angularFormMessages").directive("afSubmit",["$rootScope","$timeout","MessageService",function(a,b,c){return{require:["form","afSubmit"],controller:angular.noop,link:{pre:function(a,b,d,e){var f=e[1],g=a.$eval(d.afScrollToError);f.scrollToError=!!(void 0===g?c.scrollToError():g);var h=a.$eval(d.afShowSuccess);f.showSuccess=!!(void 0===h?c.showSuccess():h),f.triggerOn=d.afTriggerOn},post:function(c,d,e,f){function g(a){return angular.isObject(a)&&"function"==typeof a.then}function h(f){f.preventDefault(),c.$broadcast("validate"),c.$apply(function(){function f(c){angular.forEach(c.validation,function(b,c){angular.forEach(b,function(b,d){a.$broadcast("setValidity",c+"."+d,b)})}),b(function(){var a=d[0].querySelector(".ng-invalid[af-field]");i.scrollToError&&a&&a.focus()})}if(j.$valid){var h=c.$eval(e.afSubmit);g(h)&&(c.isSubmitting=!0,h["catch"](f)["finally"](function(){c.isSubmitting=!1}))}})}var i=f[1],j=f[0];d.on("submit",h)}}}}]),angular.module("angularFormMessages").directive("afSubmitButton",function(){return{link:function(a,b,c){a.$watch("isSubmitting",function(a){c.$set("disabled",a?"disabled":void 0)})}}}),angular.module("angularFormMessages").constant("MESSAGE_TYPES",["SUCCESS","INFO","WARNING","ERROR"]).provider("MessageService",["MESSAGE_TYPES",function(a){var b,c=!0,d=!1,e="change";this.setGenericLabelPrefix=function(a){b=a},this.setScrollToError=function(a){c=a},this.setShowSuccess=function(a){d=a},this.setTriggerOn=function(a){e=a},this.$get=["$injector",function(f){return{determineMessageType:function(b){var c=-1;return angular.forEach(b,function(b){var d=a.indexOf(b.type);d>c&&(c=d)}),-1===c?void 0:a[c]},validation:function(a,b){f.get("$rootScope").$on("validation",function(c,d,e,f){d===a&&b(e,f)})},getGenericLabelPrefix:function(){return b?b+".":""},scrollToError:function(){return c},showSuccess:function(){return d},triggerOn:function(){return e}}}]}]);